impliment global variables from init
refine sniffer